Код просто ужас! Лучше не открывай :o
